<div class="max-w-3xl mx-auto mt-8">

  <%# --- 選択中 menu_ids を取得して配列化 --- %>
  <% selected_menu_ids = Array(params[:menu_ids]) %>
  
  <!-- フィルターエリア -->
  <div class="card bg-base-100 shadow p-4 inline-block max-w-2xl mx-auto">
    <div id="genreFilters" class="flex gap-2 flex-wrap">

      <!-- 全部ボタン -->
      <button
        class="btn genre-filter-button
               bg-[#bebbf7]/40
               text-gray-700
               border border-[#bebbf7]
               hover:bg-[#bebbf7]/60"
        data-genre="all"
        type="button">
        すべて
      </button>

      <% ordered_genres = %w[main side soup staple] %>

      <% ordered_genres.each do |genre| %>
        <button
          class="btn genre-filter-button <%= genre_button_class(genre) %>"
          data-genre="<%= genre %>"
          type="button">
          <%= MasterMenu.genres_i18n[genre] %>
        </button>
      <% end %>

    </div>
  </div>

  <%= form_with url: import_from_master_my_menus_path,
                method: :post,
                data: { controller: "modal", turbo_frame: "_top" } do |f| %>

    <div class="bg-[#faf0e6] p-8 mt-6 rounded-2xl space-y-6">
      <div class="flex flex-wrap gap-4">

        <% @master_menus.each do |menu| %>
          <label
            class="menu-card relative px-5 py-3 rounded-xl bg-white text-sm
                   border border-base-300
                   shadow-sm transition
                   hover:shadow-md hover:bg-base-200
                   active:scale-[0.97]
                   peer-checked:bg-[#907abf]/10
                   peer-checked:border-[#907abf]
                   peer-checked:shadow-md"
            data-genre="<%= menu.genre %>">

            <input
              type="checkbox"
              name="menu_ids[]"
              value="<%= menu.id %>"
              class="hidden peer" />

            <span class="font-semibold peer-checked:text-[#f6a56c]">
              <%= menu.title %>
            </span>
          </label>
        <% end %>

      </div>
    </div>

    <div class="pt-6 flex justify-center gap-4">
      <%= f.submit "OK",
            class: "action-primary" %>

      <%= link_to my_menus_path, class: "nav-back-button" do %>
        ← 戻る
      <% end %>
    </div>

  <% end %>

  <%= turbo_frame_tag "modal" %>

</div>
