<div data-controller="meal-plans-new" class="max-w-3xl mx-auto mt-8 space-y-6">

  <h1 class="text-3xl font-bold">献立作成</h1>

  <!-- フィルターエリア -->
  <div class="card bg-base-100 shadow px-8 py-4  max-w-2xl mx-auto">
    <!-- 中央寄せ用ラッパー -->
    <div class="max-w-4xl mx-auto space-y-4">
      <!-- 1段目：ジャンル + 並び替え -->
      <div class="flex flex-col md:flex-row md:items-center gap-4">

        <!-- 左：ジャンル -->
        <div class="flex-1">
          <div id="genreFilters" class="flex gap-2 flex-wrap">
            <% MyMenu.genres.keys.each do |genre| %>
              <button
                class="btn btn-sm genre-filter-button <%= genre_button_class(genre) %>"
                data-genre="<%= genre %>"
                type="button">
                <%= MyMenu.genres_i18n[genre] %>
                <span
                  id="count-<%= genre %>"
                  class="ml-1 hidden text-xs font-bold bg-primary text-white rounded-full px-1.5">
                </span>
              </button>
            <% end %>
          </div>
        </div>

        <!-- 右：並び替え -->
        <div class="w-full md:w-56">
          <select id="sortSelect" class="select select-bordered w-full">
            <option value="">---</option>
            <option value="created_desc">登録日（新しい順）</option>
            <option value="last_cooked_desc">直近で作っていない順</option>
            <option value="title_asc">50音順</option>
          </select>
        </div>
      </div>

      <!-- 2段目：タグ -->
      <% if @tags.present? %>
        <div>
          <div id="tagFilters" class="flex gap-2 flex-wrap">
            <% @tags.each do |tag| %>
              <button
                type="button"
                class="badge badge-outline hover:badge-primary cursor-pointer tag-filter-button"
                data-tag-id="<%= tag.id %>">
                <%= tag.name %>
              </button>
            <% end %>
          </div>
        </div>
      <% end %>
    </div>
  </div>
  <%= form_with url: confirm_meal_plans_path, method: :post, data: { turbo_frame: "modal" } do %>

    <!-- メニュー一覧 -->
    <div class="bg-[#faf0e6] p-6 rounded-2xl">
      <div id="menuList" class="grid grid-cols-1 sm:grid-cols-2 gap-4">

         <% @my_menus.each do |menu| %>
          <label
            class="menu-item block p-4 rounded-xl border border-base-300 bg-white shadow-sm
                   hover:shadow-md transition cursor-pointer
                   peer-checked:bg-primary/10 peer-checked:border-primary"
            data-genre="<%= menu.genre %>"
            data-tags="<%= menu.tags.pluck(:id).join(',') %>"
            data-created="<%= menu.created_at.to_i %>"
            data-last-cooked="<%= menu.last_cooked_at ? menu.last_cooked_at.to_time.to_i : 0 %>"
            data-title="<%= menu.title %>">

            <div class="flex items-center gap-3">
              <%= check_box_tag "my_menu_ids[]", menu.id, false,
                    class: "menu-checkbox peer checkbox checkbox-sm" %>

              <span class="text-sm sm:text-base font-medium">
                <%= menu.title %>
              </span>
            </div>
          </label>

        <% end %>

      </div>
    </div>

  <div class="pt-6 flex justify-center gap-4">
    <%= submit_tag "登録内容を確認",
        class: "btn bg-[#8469bf] text-white border-none hover:bg-[#8469bf]" %>

    <%= link_to home_path,
        class: "btn bg-white text-base-content border border-base-300 hover:bg-base-200" do %>
          ← ホーム
    <% end %>
  </div>
  <% end %>

  <%= turbo_frame_tag "modal" %>
</div>
