<div class="max-w-2xl mx-auto mt-8 space-y-8">

  <!-- ヘッダー -->
  <div class="flex items-center justify-between">
    <h1 class="text-3xl font-bold">マイメニュー一覧</h1>

    <%= link_to home_path, class: "btn btn-outline btn-sm" do %>
      ← ホーム
    <% end %>
  </div>

  <!-- フィルターエリア -->
  <div class="card bg-base-100 shadow p-4">
    <%= form_with url: my_menus_path, method: :get, local: true do |f| %>

      <div class="grid grid-cols-1 md:grid-cols-3 gap-4 items-end">

        <div class="form-control">
          <label class="label text-sm font-medium">ジャンル</label>
          <%= f.select :genre,
                options_for_select(MyMenu.genre_options, @genre),
                { include_blank: "すべて" },
                class: "select select-bordered" %>
        </div>

        <div class="form-control">
          <label class="label text-sm font-medium">並び替え</label>
          <%= f.select :sort,
                options_for_select(
                  [
                    ["最終調理日（新しい順）", "last_cooked_desc"],
                    ["登録日（新しい順）", "created_desc"],
                    ["メニュー名（50音順）", "title_asc"],
                  ],
                  @sort
                ),
                {},
                class: "select select-bordered" %>
        </div>

        <div>
          <%= f.submit "更新", class: "btn btn-primary w-full" %>
        </div>
      </div>

      <!-- タグ -->
      <% if @tags.present? %>
        <div class="flex flex-wrap gap-2 mt-4">
          <% @tags.each do |tag| %>
            <%= link_to tag.name,
                        my_menus_path(tag_id: tag.id),
                        class: "badge badge-outline hover:badge-primary" %>
          <% end %>
        </div>
      <% end %>

    <% end %>
  </div>

  <!-- 一覧 -->
  <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
    <% @my_menus.each do |menu| %>
      <div class="relative bg-base-100 border-12 rounded-xl px-2 py-1
                  transition
                  hover:shadow-md
                  hover:-translate-y-[1px]
                  <%= genre_border_class(menu) %>">

        <!-- カード全体クリック用の透明リンク -->
        <%= link_to my_menu_path(menu),
            class: "absolute inset-0 z-0" do %>
        <% end %>

        <!-- 中身は前面に出す -->
        <div class="relative z-10 flex items-center justify-between gap-3">

          <!-- タイトル -->
          <p class="text-sm font-medium truncate flex-1">
            <%= menu.title %>
          </p>

          <!-- ボタン -->
          <div class="flex gap-1 shrink-0">
            <%= link_to "✎", edit_my_menu_path(menu),
                  class: "btn btn-ghost btn-xs
                          hover:bg-base-200
                          transition" %>

            <%= button_to "×",
                  my_menu_path(menu),
                  method: :delete,
                  data: { confirm: "本当に削除しますか?" },
                  class: "btn btn-ghost btn-xs text-error
                          hover:bg-error/10
                          transition" %>
          </div>

        </div>
      </div>
    <% end %>
  </div>

  <!-- 下部ボタン -->
  <div class="flex flex-col sm:flex-row gap-4 justify-center pt-6">
    <%= link_to "＋ 新規作成", new_my_menu_path, class: "btn btn-primary" %>
    <%= link_to "定番メニューから選ぶ",
          master_menus_path(select: true),
          class: "btn btn-outline" %>
  </div>

</div>
