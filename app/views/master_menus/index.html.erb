<div class="max-w-2xl mx-auto mt-8">

  <%# --- 選択中 menu_ids を取得して配列化 --- %>
  <% selected_menu_ids = Array(params[:menu_ids]) %>

  <!-- ページタイトル -->
  <div class="flex items-center justify-between mb-6">
    <h1 class="text-3xl font-bold">マスターメニュー一覧</h1>

    <%= link_to home_path, class: "btn btn-outline" do %>
      ⬅ ホームに戻る
    <% end %>
  </div>

  <!-- ジャンルフィルターボタン -->
  <div id="genreFilters" class="flex gap-2 my-4 flex-wrap">
    <% MasterMenu.genres.keys.each do |genre| %>
      <button
        class="btn btn-outline genre-filter-button"
        data-genre="<%= genre %>"
        type="button">
        <%= MasterMenu.genres_i18n[genre] %>
      </button>
    <% end %>
  </div>

  <%= form_with url: import_from_master_my_menus_path,
              method: :post,
              data: { controller: "modal", turbo_frame: "_top" } do |f| %>

    <div class="grid grid-cols-3 gap-4">
      <% @master_menus.each do |menu| %>
        <div class="p-4 border rounded shadow" data-menu-box>
          <label>
            <%= check_box_tag "menu_ids[]",
                  menu.id,
                  selected_menu_ids.include?(menu.id.to_s),
                  class: "menu-checkbox mr-2",
                  data: {
                    genre: menu.genre,
                    genre_label: menu.genre_i18n
                  } %>


            <span class="font-semibold"><%= menu.title %></span>
          </label>
        </div>
      <% end %>
    </div>

    <div class="mt-4">
      <%= f.submit "登録内容を確認", class: "bg-blue-500 text-white px-4 py-2 rounded" %>
    </div>

  <% end %>
</div>

<%= turbo_frame_tag "modal" %>
