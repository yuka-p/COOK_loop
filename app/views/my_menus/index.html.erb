<div class="max-w-3xl mx-auto mt-8">

  <!-- ヘッダー -->
  <div class="flex items-center justify-between">
    <h1 class="text-3xl font-bold">マイメニュー一覧</h1>
  </div>

<!-- フィルターエリア -->
<div class="card bg-base-100 shadow px-8 py-4  max-w-2xl mx-auto">
  <%= form_with url: my_menus_path, method: :get, local: true, id: "filterForm" do |f| %>

    <!-- ジャンル（hiddenで送信） -->
    <%= hidden_field_tag :genre, params[:genre] || "all", id: "genreInput" %>

    <!-- 中央寄せ用ラッパー -->
    <div class="max-w-4xl mx-auto space-y-4">

      <!-- 1段目：ジャンル + 並び替え -->
      <div class="flex flex-col md:flex-row md:items-center gap-4">

        <!-- 左：ジャンルボタン -->
        <div class="flex-1">
          <div id="genreFilters" class="flex gap-2 flex-wrap">
            <button
              class="btn btn-sm genre-filter-button
                     bg-[#bebbf7]/40
                     text-gray-700
                     border border-[#bebbf7]
                     hover:bg-[#bebbf7]/60"
              data-genre="all"
              type="button">
              全部
            </button>

            <% MyMenu.genres.keys.each do |genre| %>
              <button
                class="btn btn-sm genre-filter-button <%= genre_button_class(genre) %>"
                data-genre="<%= genre %>"
                type="button">
                <%= MyMenu.genres_i18n[genre] %>
                <span
                  id="count-<%= genre %>"
                  class="ml-1 hidden text-xs font-bold bg-primary text-white rounded-full px-1.5">
                </span>
              </button>
            <% end %>
          </div>
        </div>

        <!-- 右：並び替え（幅固定で中央寄りに） -->
        <div class="w-full md:w-56">
          <%= f.select :sort,
            options_for_select(
              [
                ["最終調理日（新しい順）", "last_cooked_desc"],
                ["登録日（新しい順）", "created_desc"],
                ["メニュー名（50音順）", "title_asc"],
              ],
              params[:sort]
            ),
            {},
            class: "select select-bordered w-full",
            id: "sortSelect"
          %>
        </div>
      </div>

      <!-- 2段目：タグ（ジャンルの下・左寄せ） -->
      <% if @tags.present? %>
        <div class="flex flex-wrap gap-2">
          <% @tags.each do |tag| %>
            <%= link_to tag.name,
                        my_menus_path(tag_id: tag.id),
                        class: "badge badge-outline hover:badge-primary" %>
          <% end %>
        </div>
      <% end %>

    </div>
  <% end %>
</div>

  <!-- 一覧 -->
  <!-- 背景ブロック全体 -->
<div class="bg-[#faf0e6] p-8 rounded-2xl my-6 space-y-6">

  <!-- ボタンエリア -->
  <div class="flex flex-col sm:flex-row gap-4 justify-center">
    <%= link_to "＋ 新規作成", new_my_menu_path,
      class: "btn bg-[#9582bf] text-white border-none hover:bg-[#8570b3]" %>
    <%= link_to "定番メニューから選ぶ",
          master_menus_path(select: true),
          class: "btn btn-outline" %>
  </div>

  <!-- メニュー一覧グリッド -->
  <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
    <% @my_menus.each do |menu| %>
      <div class="relative bg-base-100 border-6 rounded-xl px-2 py-1
                  transition
                  hover:shadow-md
                  hover:-translate-y-[1px]
                  <%= genre_border_class(menu) %>">

        <%= link_to my_menu_path(menu), class: "absolute inset-0 z-0" do %>
        <% end %>

        <div class="relative z-10 flex items-center gap-3">
  <p class="text-sm font-semibold truncate flex-1">
    <%= menu.title %>
  </p>

  <div class="flex gap-0.5 shrink-0 ml-auto">
    <%= link_to "✎", edit_my_menu_path(menu),
          class: "btn btn-ghost btn-xs hover:bg-base-200 transition" %>
  </div>
</div>

      </div>
    <% end %>
  </div>  
</div>
<div class="flex justify-center">
  <%= link_to home_path, class: "btn bg-white text-base-content border border-base-300 hover:bg-base-200" do %>
    ← ホーム
  <% end %>
</div>
